# <center> node-basics </center>
## <center> ДЗ 24. Завдання: Розробка RESTful API для блогу із захищеними ресурсами </center>

### Опис завдання
Необхідно створити RESTful API для блогу, де користувачі зможуть реєструватися, логінитися та управляти своїми постами. Доступ до операцій над постами повинен бути захищеним за допомогою JWT-токенів, що гарантує, що лише авторизований користувач може створювати, переглядати, редагувати або видаляти власні пости.

### Обов’язкові вимоги
1. Створення проекту:
   * Використовуйте Node.js як середовище виконання.
   
   * Створіть сервер на базі Express.
   
   * Використовуйте MongoDB для зберігання даних (локальна БД або MongoDB Atlas).
   
   * Налаштуйте Nodemon для зручного розробницького циклу.
2. Аутентифікація користувачів:
   * Реалізуйте endpoint POST /api/auth/register для реєстрації користувача.
     * Обов’язкові поля: username, email, password.
     
     * Забезпечте хешування паролів (наприклад, за допомогою bcrypt).
     
   * Реалізуйте endpoint POST /api/auth/login для входу користувача.
   
     * Після успішної аутентифікації поверніть JWT-токен, який містить ідентифікатор користувача.
3. Захищені маршрути для постів:
     
   * Створіть модель Post з такими полями:
        
     * title – заголовок посту.
          
     * content – зміст посту.
          
     * owner – посилання (ID) на користувача, який створив пост.
          
     * Додаткові метадані (дати створення, оновлення) – за бажанням.
4. Реалізуйте наступні CRUD операції для постів (endpoint’и повинні бути захищені middleware, який перевіряє JWT-токен):
   * GET /api/posts – отримання всіх постів поточного користувача.
             
   * GET /api/posts/:id – отримання конкретного посту за ID.
             
   * POST /api/posts – створення нового посту.
             
   * PUT /api/posts/:id – оновлення посту (дозволяється лише для власника).
             
   * DELETE /api/posts/:id – видалення посту (дозволяється лише для власника).
             
5. JWT (JSON Web Token):
   * Реалізуйте middleware для перевірки JWT-токена, який перевірятиме токен, отриманий у заголовку Authorization (формат: Bearer <token>).
                
   * Поясніть у README.md, як працює JWT:
                
     * Що таке JWT. -- JSON Web Token (JWT) — це стандарт відкритого веб-формату, який дозволяє передавати дані між двома сторонами (наприклад, сервером і клієнтом) у вигляді компактного і безпечного токена. JWT часто використовують для аутентифікації та авторизації користувачів у веб-застосунках та API.
                  
     * Які дані містяться у токені. -- У токені можуть міститися будь-які дані
                  
     * Як формується токен (підписування секретним ключем). -- JWT формується шляхом комбінування трьох частин: Header: Серіалізується в JSON і кодується в Base64URL. Payload: Серіалізується в JSON і кодується в Base64URL. Signature: Створюється за допомогою секретного ключа або пари ключів (публічний і приватний), що використовується для підпису.
                  
     * Переваги використання JWT (статлес аутентифікація, масштабованість, безпека). -- Статлес аутентифікація: Не потрібно зберігати сесії на сервері, що спрощує масштабування. Продуктивність: Відсутність необхідності у пошуку сесійних даних на сервері. Безпека: Токен підписується, тому не можна змінити його вміст без знання секретного ключа. Гнучкість: Використовується для різних типів клієнтів та платформ. 
                  
     * Альтернативи JWT (сесійна аутентифікація, OAuth/OIDC). -- Сесійна аутентифікація: Класичний підхід, коли сервер створює сесію після логіну, зберігаючи дані сесії (наприклад, в пам’яті або в базі даних), а клієнт отримує sessionID через cookie. OAuth / OpenID Connect (OIDC): Протоколи для делегованої аутентифікації та авторизації, які часто використовуються для входу через сторонні сервіси (Google, Facebook).  
                  
6. Документація:
                
   * Створіть файл README.md, у якому опишіть:
     * Структуру проекту:  

     * Як встановити залежності та запустити сервер.
                  
     * Детальний опис API ендпоінтів із прикладами запитів (наприклад, для Postman).
                  
     * Огляд роботи JWT та сесій користувача (що таке сесія, які види сесій існують, як реалізована клієнтська сесія через JWT).
                  
7. Бонусне завдання (опціонально)
   * Реалізація функціональності refresh token:
     * Додайте механізм оновлення JWT-токена за допомогою refresh токена. Це дозволить користувачам отримувати новий токен без повторного логіну, коли поточний токен закінчився.
                  
   * Розширення функціональності:
                
     * Реалізуйте модель Comment для коментарів до постів.
                  
     * Створіть endpoint’и для додавання, перегляду та видалення коментарів до постів.
                  
     * Забезпечте, щоб лише власник коментаря міг його редагувати або видаляти.
                  
8. Критерії оцінювання
   * Функціональність:
             
     * API повинен коректно виконувати всі зазначені операції (реєстрація, логін, CRUD для постів).
               
   * Безпека:
             
     * Паролі повинні бути надійно хешовані, а доступ до захищених ресурсів – обмежений перевіркою JWT.
             
   * Структура коду:
             
     * Проект має бути організований згідно з best practices (розділення файлів, використання middleware, контролерів, моделей).
             
   * Документація:
             
     * README.md повинен містити чітке пояснення принципів роботи API, JWT та сесій користувача.
             
   * Додаткові можливості:
             
     * Реалізація refresh токена або коментарів розглядається як бонус та підвищує оцінку.
               
9. Додаткові рекомендації
               
   * Контроль версій:
               
     * Використовуйте Git для контролю версій коду. Робіть регулярні коміти з відповідними повідомленнями.
               
   * Тестування:
               
     * Тестуйте ваші API endpoint’и за допомогою Postman або іншого інструменту для тестування REST API.
               
   * Ресурси для навчання:
     * Документація Node.js
                    
     * Express.js документація
                    
     * MongoDB документація
                    
     * JWT.io

### Структуру проекту:
```
project/
├── config/
│   └── config.js            # Конфігурація (порт, MongoDB URI, секрет для JWT)
├── controllers/
│   ├── authController.js    # Логіка реєстрації та логіну
│   ├── commentsController.js# Логіка для CRUD операцій з коментами
│   └── postsController.js   # Логіка для CRUD операцій з постами
├── middlewares/
│   └── authMiddleware.js    # Middleware для перевірки JWT токену
├── models/
    ├── Comment.js           # Модель коменту
│   ├── User.js              # Модель користувача
│   └── Post.js              # Модель посту
├── routes/
│   ├── authRoutes.js        # Маршрути аутентифікації
│   ├── commentsRoutes.js    # Захищені маршрути для коментів
│   └── postsRoutes.js       # Захищені маршрути для постів
├── server.js                # Основний файл ініціалізації сервера
└── package.json             # Залежності та скрипти для запуску
```

### Installation and Running

#### Передумови:
- **Node.js** встановлено на вашій машині.
- **MongoDB** запущено локально.

### Кроки:
1. **Клонувати репозиторій:**
   ```bash
   git clone <repository_url>
   cd node-basics
   ```
2. **Встановити залежності:**
   ```bash
   npm i
   ```
3. **Запустити сервер:**
    - Для розробки (автоматичний перезапуск):
    ```bash
    npm run dev
    ```
    - Для звичайного запуску:
    ```bash
    npm start
    ```

### API Endpoints

- **POST** `/api/auth/register`  
  Реєстрація нового користувача.  
  _Body (JSON):_
  ```json
  {
    "username": "john_doe",
    "email": "john@example.com",
    "password": "123456"
   }
  ```

- **POST** `/api/auth/login`  
  Логін користувача. При успішній аутентифікації повертається JWT токен.  
  _Body (JSON):_
  ```json
  {
    "email": "john@example.com",
    "password": "123456"
  }
  ```
